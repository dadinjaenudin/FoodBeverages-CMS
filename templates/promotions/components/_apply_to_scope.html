<!-- Apply To Scope - Category/Product Selection -->
<div class="bg-white border border-gray-200 rounded-lg px-4 py-3">
    <h3 class="text-sm font-semibold text-gray-900 mb-2">
        <i class="fas fa-filter text-blue-600 mr-2"></i>Apply To
        {% if request.current_brand %}
        <span class="text-xs font-normal text-blue-600">(Filtered by: {{ request.current_brand.name }})</span>
        {% endif %}
    </h3>
    
    <div class="space-y-2">
        <!-- Apply To Selection -->
        <div>
            <label for="id_apply_to" class="block text-xs font-medium text-gray-700 mb-1">
                Promotion Scope <span class="text-red-500">*</span>
            </label>
            <select name="apply_to" 
                    id="id_apply_to" 
                    x-model="applyTo" 
                    required 
                    class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <option value="all">üåê All Products</option>
                <option value="category">üì¶ Specific Categories</option>
                <option value="product">üçî Specific Products</option>
            </select>
            <p class="mt-1 text-xs text-gray-500">Define which products this promotion applies to</p>
        </div>

        <!-- Category Multi-Select (show when apply_to = 'category') -->
        <div x-show="applyTo === 'category'" x-transition class="mt-2">
            <label class="block text-xs font-medium text-gray-700 mb-2">
                Select Categories <span class="text-red-500">*</span>
            </label>
            
            <button type="button"
                    @click="showCategoryModal = true"
                    class="w-full px-4 py-3 bg-blue-50 border-2 border-blue-300 border-dashed rounded-lg hover:bg-blue-100 transition-colors">
                <div class="flex items-center justify-center gap-2 text-blue-700">
                    <i class="fas fa-folder-open text-lg"></i>
                    <span class="font-medium">Select Categories</span>
                    <span class="text-xs" x-show="selectedCategoryCount > 0">
                        (<span x-text="selectedCategoryCount"></span> selected)
                    </span>
                </div>
            </button>
            
            <p class="mt-2 text-xs text-gray-600">
                <i class="fas fa-info-circle mr-1"></i>
                Promotion will apply to all products within selected categories
            </p>
        </div>

        <!-- Product Multi-Select (show when apply_to = 'product') -->
        <div x-show="applyTo === 'product'" x-transition class="mt-2">
            <label class="block text-xs font-medium text-gray-700 mb-2">
                Select Products <span class="text-red-500">*</span>
            </label>
            
            <button type="button"
                    @click="showProductModal = true"
                    class="w-full px-4 py-3 bg-blue-50 border-2 border-blue-300 border-dashed rounded-lg hover:bg-blue-100 transition-colors">
                <div class="flex items-center justify-center gap-2 text-blue-700">
                    <i class="fas fa-box-open text-lg"></i>
                    <span class="font-medium">Select Products</span>
                    <span class="text-xs" x-show="selectedProductCount > 0">
                        (<span x-text="selectedProductCount"></span> selected)
                    </span>
                </div>
            </button>
            
            <p class="mt-2 text-xs text-gray-600">
                <i class="fas fa-info-circle mr-1"></i>
                Promotion will apply only to selected products
            </p>
        </div>

        <!-- All Products Info (show when apply_to = 'all') -->
        <div x-show="applyTo === 'all'" x-transition class="mt-2 px-3 py-2 rounded-lg bg-blue-50 border border-blue-200">
            <div class="flex items-start gap-2 text-xs text-blue-700">
                <i class="fas fa-globe mt-0.5"></i>
                <div>
                    <p class="font-medium">All Products Selected</p>
                    <p class="mt-1">This promotion will apply to all products in the selected stores, unless you exclude specific items.</p>
                </div>
            </div>
        </div>
    </div>
</div>
